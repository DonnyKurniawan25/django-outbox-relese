!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,a,o){t.hasOwnProperty(e)||(t[e]=o.apply(null,a),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t=t?t._modules:{},"Extensions/DownloadURL.js",[t["Core/Globals.js"]],function(t){var i=t.isSafari,r=t.win,s=r.document,n=r.URL||r.webkitURL||r,l=t.dataURLtoBlob=function(t){if((t=t.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<t.length&&r.atob&&r.ArrayBuffer&&r.Uint8Array&&r.Blob&&n.createObjectURL){for(var e=r.atob(t[3]),a=new r.ArrayBuffer(e.length),a=new r.Uint8Array(a),o=0;o<a.length;++o)a[o]=e.charCodeAt(o);return t=new r.Blob([a],{type:t[1]}),n.createObjectURL(t)}};return t=t.downloadURL=function(e,t){var a=r.navigator,o=s.createElement("a");if("string"==typeof e||e instanceof String||!a.msSaveOrOpenBlob){if(e="".concat(e),a=/Edge\/\d+/.test(a.userAgent),(i&&"string"==typeof e&&0===e.indexOf("data:application/pdf")||a||2e6<e.length)&&!(e=l(e)||""))throw Error("Failed to convert to blob");if(void 0!==o.download)o.href=e,o.download=t,s.body.appendChild(o),o.click(),s.body.removeChild(o);else try{var n=r.open(e,"chart");if(null==n)throw Error("Failed to open window")}catch(t){r.location.href=e}}else a.msSaveOrOpenBlob(e,t)},{dataURLtoBlob:l,downloadURL:t}}),e(t,"Extensions/ExportData.js",[t["Core/Axis/Axis.js"],t["Core/Chart/Chart.js"],t["Core/Renderer/HTML/AST.js"],t["Core/Globals.js"],t["Core/DefaultOptions.js"],t["Core/Utilities.js"],t["Extensions/DownloadURL.js"]],function(h,t,o,e,a,n,i){function r(t,e){var a,o=d.navigator,n=-1<o.userAgent.indexOf("WebKit")&&o.userAgent.indexOf("Chrome")<0,i=d.URL||d.webkitURL||d;try{return o.msSaveOrOpenBlob&&d.MSBlobBuilder?((a=new d.MSBlobBuilder).append(t),a.getBlob("image/svg+xml")):n?void 0:i.createObjectURL(new d.Blob(["\ufeff"+t],{type:e}))}catch(t){}}var l=this&&this.__spreadArray||function(t,e,a){if(a||2===arguments.length)for(var o,n=0,i=e.length;n<i;n++)!o&&n in e||((o=o||Array.prototype.slice.call(e,0,n))[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))},s=e.doc,c=e.seriesTypes,d=e.win,p=(e=a.getOptions,a=a.setOptions,n.addEvent),C=n.defined,u=n.extend,A=n.find,S=n.fireEvent,E=n.isNumber,L=n.pick,f=i.downloadURL,m=(a({exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table"}}),p(t,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}),p(t,"afterViewData",function(){var r=this,s=r.dataTableDiv,t=document.querySelectorAll("thead")[0].querySelectorAll("tr")[0];s&&t.childNodes.forEach(function(a){var i=a.closest("table");a.addEventListener("click",function(){var o,n,t=l([],s.querySelectorAll("tr:not(thead tr)"),!0),e=l([],a.parentNode.children,!0);t.sort((o=e.indexOf(a),n=r.ascendingOrderInTable=!r.ascendingOrderInTable,function(t,e){var a=(n?t:e).children[o].textContent;return t=(n?e:t).children[o].textContent,""===a||""===t||isNaN(a)||isNaN(t)?a.toString().localeCompare(t):a-t})).forEach(function(t){i.appendChild(t)}),e.forEach(function(e){["highcharts-sort-ascending","highcharts-sort-descending"].forEach(function(t){e.classList.contains(t)&&e.classList.remove(t)})}),a.classList.add(r.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")})})}),t.prototype.setUpKeyToAxis=function(){c.arearange&&(c.arearange.prototype.keyToAxis={low:"y",high:"y"}),c.gantt&&(c.gantt.prototype.keyToAxis={start:"x",end:"x"})},t.prototype.getDataRows=function(u){function a(t,e,a){if(x.columnHeaderFormatter){var o=x.columnHeaderFormatter(t,e,a);if(!1!==o)return o}return t?t instanceof h?t.options.title&&t.options.title.text||(t.dateTime?i:n):u?{columnTitle:1<a?e:t.name,topLevelColumnTitle:t.name}:t.name+(1<a?" ("+e+")":""):n}function f(a,t,o){var n={},i={};return t.forEach(function(t){var e=(a.keyToAxis&&a.keyToAxis[t]||t)+"Axis",e=E(o)?a.chart[e][o]:a[e];n[t]=e&&e.categories||[],i[t]=e&&e.dateTime}),{categoryMap:n,dateTimeValueAxisMap:i}}var o,m=this.hasParallelCoordinates,g=this.time,x=this.options.exporting&&this.options.exporting.csv||{},b=this.xAxis,y={},t=[],v=[],w=[],e=this.options.lang.exportData,n=e.categoryHeader,i=e.categoryDatetimeHeader,T=[],D=0;for(r in this.setUpKeyToAxis(),this.series.forEach(function(n){var i,t,e,r=n.xAxis,s=n.options.keys||(e=r,(t=n).data.filter(function(t){return void 0!==t.y&&t.name}).length&&e&&!e.categories&&!t.keyToAxis?t.pointArrayMap&&t.pointArrayMap.filter(function(t){return"x"===t}).length?(t.pointArrayMap.unshift("x"),t.pointArrayMap):["x","y"]:t.pointArrayMap||["y"]),l=s.length,c=!n.requireSorting&&{},h=b.indexOf(r),d=f(n,s);if(!1!==n.options.includeInDataExport&&!n.options.isInternal&&!1!==n.visible){for(A(T,function(t){return t[0]===h})||T.push([h,D]),i=0;i<l;)o=a(n,s[i],s.length),w.push(o.columnTitle||o),u&&v.push(o.topLevelColumnTitle||o),i++;var p={chart:n.chart,autoIncrement:n.autoIncrement,options:n.options,pointArrayMap:n.pointArrayMap};n.options.data.forEach(function(t,e){m&&(d=f(n,s,e));var a={series:p},o=(n.pointClass.prototype.applyOptions.apply(a,[t]),t=a.x,n.data[e]&&n.data[e].name);for(i=0,(!r||"name"===n.exportKey||!m&&r&&r.hasNames&&o)&&(t=o),c&&(c[t]&&(t+="|"+e),c[t]=!0),y[t]||(y[t]=[],y[t].xValues=[]),y[t].x=a.x,y[t].name=o,y[t].xValues[h]=a.x;i<l;)e=s[i],y[t][D+i]=L(d.categoryMap[e][o=a[e]],d.dateTimeValueAxisMap[e]?g.dateFormat(x.dateFormat,o):null,o),i++}),D+=i}}),y)Object.hasOwnProperty.call(y,r)&&t.push(y[r]);for(var r=u?[v,w]:[w],D=T.length;D--;){var s=T[D][0],l=T[D][1],c=b[s];t.sort(function(t,e){return t.xValues[s]-e.xValues[s]}),e=a(c),r[0].splice(l,0,e),u&&r[1]&&r[1].splice(l,0,e),t.forEach(function(t){var e=t.name;c&&!C(e)&&(e=c.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),g.dateFormat(x.dateFormat,t.x)):c.categories?L(c.names[t.x],c.categories[t.x],t.x):t.x),t.splice(l,0,e)})}return r=r.concat(t),S(this,"exportData",{dataRows:r}),r},t.prototype.getCSV=function(t){var n="",i=this.getDataRows(),e=this.options.exporting.csv,r=L(e.decimalPoint,","!==e.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),s=L(e.itemDelimiter,","===r?";":","),l=e.lineDelimiter;return i.forEach(function(t,e){for(var a,o=t.length;o--;)"number"==typeof(a="string"==typeof(a=t[o])?'"'+a+'"':a)&&"."!==r&&(a=a.toString().replace(".",r)),t[o]=a;t.length=i.length?i[0].length:0,n+=t.join(s),e<i.length-1&&(n+=l)}),n},t.prototype.getTable=function(t){var e=function(t){var a,o;return t.tagName&&"#text"!==t.tagName?(a=t.attributes,o="<".concat(t.tagName),a&&Object.keys(a).forEach(function(t){var e=a[t];o+=" ".concat(t,'="').concat(e,'"')}),o=(o+=">")+(t.textContent||""),(t.children||[]).forEach(function(t){o+=e(t)}),o+="</".concat(t.tagName,">")):t.textContent||""};return t=this.getTableAST(t),e(t)},t.prototype.getTableAST=function(t){function c(t,e,a,o){var n=L(o,"");return e="highcharts-text"+(e?" "+e:""),"number"==typeof n?(n=n.toString(),","===i&&(n=n.replace(".",i)),e="highcharts-number"):o||(e="highcharts-empty"),{tagName:t,attributes:a=u({class:e},a),textContent:n}}var o=0,e=[],h=this.options,i=t?1.1.toLocaleString()[1]:".",d=L(h.exporting.useMultiLevelHeaders,!0),a=(t=this.getDataRows(d),d?t.shift():null),n=t.shift();!1!==h.exporting.tableCaption&&e.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:L(h.exporting.tableCaption,h.title.text||"Chart")});for(var r=0,s=t.length;r<s;++r)t[r].length>o&&(o=t[r].length);e.push(function(t,e,a){var o,n=[],i=0,r=(a=a||e&&e.length,0);if(o=d&&t&&e){t:if(o=t.length,e.length===o){for(;o--;)if(t[o]!==e[o]){o=!1;break t}o=!0}else o=!1;o=!o}if(o){for(o=[];i<a;++i){var s=t[i],l=t[i+1];s===l?++r:r?(o.push(c("th","highcharts-table-topheading",{scope:"col",colspan:r+1},s)),r=0):(s===e[i]?h.exporting.useRowspanHeaders?(l=2,delete e[i]):(l=1,e[i]=""):l=1,s=c("th","highcharts-table-topheading",{scope:"col"},s),1<l&&s.attributes&&(s.attributes.valign="top",s.attributes.rowspan=l),o.push(s))}n.push({tagName:"tr",children:o})}if(e){for(o=[],i=0,a=e.length;i<a;++i)void 0!==e[i]&&o.push(c("th",null,{scope:"col"},e[i]));n.push({tagName:"tr",children:o})}return{tagName:"thead",children:n}}(a,n,Math.max(o,n.length)));var l=[];return t.forEach(function(t){for(var e=[],a=0;a<o;a++)e.push(c(a?"td":"th",null,a?{}:{scope:"row"},t[a]));l.push({tagName:"tr",children:e})}),e.push({tagName:"tbody",children:l}),e={tree:{tagName:"table",id:"highcharts-data-table-".concat(this.index),children:e}},S(this,"aftergetTableAST",e),e.tree},t.prototype.downloadCSV=function(){var t=this.getCSV(!0);f(r(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")},t.prototype.downloadXLS=function(){var t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";f(r(t,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+d.btoa(unescape(encodeURIComponent(t))),this.getFilename()+".xls")},t.prototype.viewData=function(){this.toggleDataTable(!0)},t.prototype.hideData=function(){this.toggleDataTable(!1)},t.prototype.toggleDataTable=function(t){(t=L(t,!this.isDataTableVisible))&&!this.dataTableDiv&&(this.dataTableDiv=s.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv&&(this.dataTableDiv.style.display=t?"block":"none",t&&(this.dataTableDiv.innerHTML=o.emptyHTML,new o([this.getTableAST()]).addToDOM(this.dataTableDiv),S(this,"afterViewData",this.dataTableDiv))),this.isDataTableVisible=t,t=this.exportDivElements;var e=(a=this.options.exporting)&&a.buttons&&a.buttons.contextButton.menuItems,a=this.options.lang;m&&m.menuItemDefinitions&&a&&a.viewData&&a.hideData&&e&&(t=t&&t[e.indexOf("viewData")])&&o.setElementHTML(t,this.isDataTableVisible?a.hideData:a.viewData)},e().exporting);m&&(u(m.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.toggleDataTable()}}}),m.buttons&&m.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),c.map&&(c.map.prototype.exportKey="name"),c.mapbubble&&(c.mapbubble.prototype.exportKey="name"),c.treemap&&(c.treemap.prototype.exportKey="name")}),e(t,"masters/modules/export-data.src.js",[],function(){})});